<?xml version="1.0" encoding= "UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >


<mapper namespace="com.homepage.portfolio.Mapper.ReplyMapper">
	<insert id="insertReply" parameterType="com.homepage.portfolio.DTO.ReplyDTO">
		insert into reply (boardnum,rewriter,recontent,redate,reparent,redepth,reorder) values (#{boardnum),#{rewriter},#{recontent},now(),#{reparent},#{redepth},#{reorder})
	</insert>
	
	<select id="maxorder" parameterType="integer" resultType="integer">
		select ifnull(max(reorder),0) from reply where boardnum = #{boardnum
	</select>

	<select id="selectReply" parameterType="integer" resultType="com.homepage.portfolio.DTO.ReplyDTO">
		select * from reply where replynum = #{replynum}
	</select>
	
	<update id="updateReply" parameterType="com.homepage.portfolio.DTO.ReplyDTO">
		update reply set recontent = #{recontent} where replynum = #{replynum}
	</update>
	
	<update id="updateOrder" parameterType="com.homepage.portfolio.DTO.ReplyDTO">
		update reply set reorder = reorder +1 where boardnum = #{boardnum} and reorder > #{reorder}
	</update>
	
	<update id="deleteReply" parameterType="com.homepage.portfolio.DTO.ReplyDTO">
		update reply set deletecontent = #{deletecontent} and recontent = #{recontent} where replynum =#{replynum}
	</update>
</mapper>